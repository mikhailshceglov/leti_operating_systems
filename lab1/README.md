# Лабораторная работа №1 по курсу "Операционные системы"

**Тема:** Файловые системы Linux-подобных ОС 
**Автор:** Щеглов Михаил, группа 3381
**Дата выполнения:** март 2025
**ОС:** Debian GNU/Linux 6.1.0-30-amd64
**Процессор:** Intel Core i7-13650HX (20 потоков)

---

## Цель

Ознакомление с типами файлов и структурой файловых систем, правами доступа, системными утилитами анализа, исследование особенностей работы с жёсткими/символьными ссылками, SUID/SGID-битами, а также принципами работы утилиты `file`.

---

## Структура проекта

```plaintext
.
├── 1_lab.pdf           # Условие лабораторной
├── lab1.log            # Основной лог (все задания, выводы, команды)
├── scripts/            # Скрипты для отдельных заданий
│   ├── lab1_task1.sh
│   ├── lab1_task2.sh
│   ├── lab1_task3.sh
│   ├── lab1_task7.sh
│   ├── lab1_task10.c
│   ├── SUID_TEST.c
│   └── suid_test_program



---

## Описание заданий

### Задание 1 — Типы файлов
Скрипт `lab1_task1.sh` ищет и сохраняет примеры всех типов файлов в корневой ФС (`-`, `b`, `c`, `d`, `l`, `p`, `s`) с использованием `ls -lR` и `pcregrep`.

### Задание 2 — Жесткие ссылки
Поиск всех жёстких ссылок на файл через `stat`, `ls -iR` и `grep`. Скрипт `lab1_task2.sh`.

### Задание 3–4 — Символические ссылки
Создание символьных ссылок разными способами (`ln -s`, `cp -s`, `link`) и их автоматический поиск. Скрипт `lab1_task3.sh`.

### Задание 5 — Утилита `find`
Разнообразный поиск файлов по дате, размеру, имени, пустоте, через `-exec` и `-printf`.

### Задание 6 — Заголовки файлов
Анализ структуры PDF, Python и Pickle файлов, а также директорий с помощью `hexdump` и `od`.

### Задание 7 — Размер каталога
Эксперимент с изменением размера каталога при добавлении и удалении большого числа файлов. Скрипт `lab1_task7.sh`.

### Задание 8 — /etc/passwd, /etc/shadow
Анализ прав доступа и структуры этих файлов. Проверка прав доступа у `/usr/bin/passwd`.

### Задание 9 — Права доступа и флаг SUID
Создание файлов, изменение прав, установка флага SUID (`chmod u+s`), выполнение программ от имени root (`suid_test_program`).

### Задание 10 — Программа-шлюз
Программа на C (`lab1_task10.c`), которая с флагом SUID считывает защищённый файл. Используется для доступа к файлам root-пользователя.

### Задание 11 — Файловые системы и монтирование
Использованы `df`, `mount`, `lsblk`, `cat /etc/mtab`, `cat /proc/mounts` для изучения:  
- точек монтирования  
- типов ФС (ext4, vfat)  
- структуры GPT-диска  
- максимально возможного пути (PATH_MAX=4096)

### Задание 12 — Утилита `file`
- Исследован принцип работы через `magic`-файлы (`/usr/share/file/magic`, `magic.mgc`).
- Расширена база определений — создан новый тип: `MY_MAGIC`, добавлен через кастомную базу.
- Протестирована с `file -m ./my_magic`.

---

## Как запускать

```bash
cd scripts/
chmod +x *.sh
./lab1_task1.sh output.txt
./lab1_task2.sh /path/to/file
./lab1_task3.sh /path/to/file
./lab1_task7.sh
gcc lab1_task10.c -o task10
sudo chown root:root task10 && sudo chmod u+s task10
./task10 /path/to/secret.txt
