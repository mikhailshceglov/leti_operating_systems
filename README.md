# Лабораторная работа №1 по курсу "Операционные системы"

**Тема:** Файловые системы Linux-подобных ОС

**Автор:** Щеглов Михаил, группа 3381

**Дата выполнения:** март 2025

**ОС:** Debian GNU/Linux 6.1.0-30-amd64

**Процессор:** Intel Core i7-13650HX (20 потоков)

---

## Цель

Ознакомление с типами файлов и структурой файловых систем, правами доступа, системными утилитами анализа, исследование особенностей работы с>

---

## Структура проекта

```plaintext
.
├── 1_lab.pdf           # Условие лабораторной
├── lab1.log            # Основной лог (все задания, выводы, команды)
├── scripts/            # Скрипты для отдельных заданий
│   ├── lab1_task1.sh
│   ├── lab1_task2.sh
│   ├── lab1_task3.sh
│   ├── lab1_task7.sh
│   ├── lab1_task10.c
│   ├── SUID_TEST.c
│   └── suid_test_program

```
---

## Описание заданий

### Задание 1 — Типы файлов
Скрипт `lab1_task1.sh` ищет и сохраняет примеры всех типов файлов в корневой ФС (`-`, `b`, `c`, `d`, `l`, `p`, `s`) с использованием `ls -lR>

### Задание 2 — Жесткие ссылки
Поиск всех жёстких ссылок на файл через `stat`, `ls -iR` и `grep`. Скрипт `lab1_task2.sh`.

### Задание 3–4 — Символические ссылки
Создание символьных ссылок разными способами (`ln -s`, `cp -s`, `link`) и их автоматический поиск. Скрипт `lab1_task3.sh`.

### Задание 5 — Утилита `find`
Разнообразный поиск файлов по дате, размеру, имени, пустоте, через `-exec` и `-printf`.

### Задание 6 — Заголовки файлов
Анализ структуры PDF, Python и Pickle файлов, а также директорий с помощью `hexdump` и `od`.

### Задание 7 — Размер каталога
Эксперимент с изменением размера каталога при добавлении и удалении большого числа файлов. Скрипт `lab1_task7.sh`.

### Задание 8 — /etc/passwd, /etc/shadow
Анализ прав доступа и структуры этих файлов. Проверка прав доступа у `/usr/bin/passwd`.

### Задание 9 — Права доступа и SUID/SGID
- Изучить и продемонстрировать изменение прав доступа к файлам (`chmod`, `chown`, `umask`).
- Установить SUID-бит на программу, чтобы она выполнялась от имени владельца (root).
- Экспериментально проверить, как итоговые права меняются при разных правах пользователя и группы.

### Задание 10 — Программа-шлюз
- Написать на C программу, которая даёт доступ к файлу другого пользователя без прямых прав чтения.
- Реализовать аналог `passwd`, где программа имеет флаг SUID root и позволяет безопасно получать содержимое закрытого файла.

### Задание 11 — Файловые системы и монтирование
- Изучить команды `df`, `lsblk`, `mount`, `cat /etc/mtab`, `cat /proc/mounts` для получения информации о ФС.
- Проанализировать точки монтирования, типы и размеры ФС, а также структуру GPT-разделов диска.
- Найти максимально возможный путь (PATH_MAX), проанализировать, где это ограничение указывается.

### Задание 12 — Утилита `file`
- **12.1** Исследовать принцип работы `file`, посмотреть расположение базы `magic` (обычно `/usr/share/file/magic` или `/etc/magic`).
- **12.2** Применить различные ключи (`-i`, `-b`, `-z`, `-k`) и показать, как `file` распознаёт разные типы файлов (PDF, ELF, текст).
- **12.3** Добавить собственное определение типа файла в базу `magic`, проверить его работу командой:
  ```bash
  file -m ./my_magic test_custom_file
  test_custom_file: My Custom File Type
